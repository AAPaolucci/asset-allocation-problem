---
title: "Asset-allocation"
author: "Arthur Paolucci"
date: "02/10/2020"
output:
  word_document: default
  html_document: default
---

```{r setup, include=F}
chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
```

```{r cabeçalho, echo = F, evaluate = T, message = F, warning = F, include = F}
## Asset Allocation Problem
# Este código tem o objetivo de estimar a alocação do fundo de investimentos multimercados JGP Strategy Master na janela de tempo definida.
```

```{r limpeza de memória, include = F}
rm(list = ls())
```

```{r definindo as opções, include = FALSE}
options(OutDec = ".", round = 2, digits = c(5,2))
```

```{r pacotes, echo = T, eval = T, message = T, warning = T, include = F}
# Pacotes populares: readxl, dplyr, tidyr, stringr, lubridate, plotly, dygraphs, data.table, tibble, zoo, xts, quantmod, BETs, sidrar. 
packset = c("readxl","tidyr","dplyr","lubridate","xts","PerformanceAnalytics","plotly","dygraphs","dplyr", "quadprog")
not_inst <- packset[!(packset %in% installed.packages()[,"Package"])]
if(length(not_inst)) install.packages(not_inst)
lapply(packset, require, character.only = TRUE)
```

# Asset Allocation Problem

### Problema

### Revisão Bibliográfica

### Base de Dados

##### Importando os dados da Economatica

A FGV disponibiliza aos alunos o acesso à base de dados economatica. Para esse trabalho temos o interesse em obter as cotações do fundo analisado (JGP Strategy...) e dos índices que servirão como proxy para os fatores de risco.

Entretanto, para trabalhar esse conjunto de dados como cross-sectional devemos utilizar os retornos ao invés dos níveis de preço.

```{r database, echo = F, eval = T, include = F}
# Importar planilhas excel para cada conjunto de dados (readxl)
verde <-  read_xlsx('database.xlsx',sheet='VERDE', skip=3, col_names=T)
ibov <- read_xlsx('database.xlsx',sheet='IBOV', skip=3, col_names=T)
snp <- read_xlsx('database.xlsx',sheet='S&P 500', skip=3, col_names=T)
imab5 <- read_xlsx('database.xlsx',sheet='IMA-B 5', skip=3, col_names=T)
imab5p <- read_xlsx('database.xlsx',sheet='IMA-B 5+', skip=3, col_names=T)
dolar <- read_xlsx('database.xlsx',sheet='DOLX20', skip=3, col_names=T)
di17 <- read_xlsx('database.xlsx',sheet='DI1N17', skip=3, col_names=T)
di19 <- read_xlsx('database.xlsx',sheet='DI1N19', skip=3, col_names=T)
di21 <- read_xlsx('database.xlsx',sheet='DI1N21', skip=3, col_names=T)
di23 <- read_xlsx('database.xlsx',sheet='DI1N23', skip=3, col_names=T)
di25 <- read_xlsx('database.xlsx',sheet='DI1N25', skip=3, col_names=T)

# Transformar em timeseries object
verde <- as.xts(verde[,'Cota'],order.by = verde$Data)
ibov <- as.xts(ibov[,'Fechamento'],order.by = ibov$Data)
snp <- as.xts(snp[,'Fechamento'],order.by = snp$Data)
imab5 <- as.xts(imab5[,'Fechamento'],order.by = imab5$Data)
imab5p <- as.xts(imab5p[,'Fechamento'],order.by = imab5p$Data)
dolar <- as.xts(dolar[,'Fechamento'],order.by = dolar$Data)
di17 <- as.xts(di17[,'Fechamento'],order.by = di17$Data)
di19 <- as.xts(di19[,'Fechamento'],order.by = di19$Data)
di21 <- as.xts(di21[,'Fechamento'],order.by = di21$Data)
di23 <- as.xts(di23[,'Fechamento'],order.by = di23$Data)
di25 <- as.xts(di25[,'Fechamento'],order.by = di25$Data)

# Converter '-' para NA
verde <- na_if(verde$Cota,"-")
ibov <- na_if(ibov$Fechamento,"-")
snp <- na_if(snp$Fechamento,"-")
imab5 <- na_if(imab5$Fechamento,"-")
imab5p <- na_if(imab5p$Fechamento,"-")
dolar <- na_if(dolar$Fechamento,"-")
di17 <- na_if(di17$Fechamento,"-")
di19 <- na_if(di19$Fechamento,"-")
di21 <- na_if(di21$Fechamento,"-")
di23 <- na_if(di23$Fechamento,"-")
di25 <- na_if(di25$Fechamento,"-")

# Merge xts
dat <- merge.zoo(verde, ibov, snp, imab5, imab5p, dolar, 
                 di17, di19, di21, di23, di25,
                 fill=NA, all=T, 
                 suffixes=c('verde', 'ibov', 'snp',
                            'imab5', 'imab5p', 'dolar',
                            'di17', 'di19', 'di21', 'di23', 'di25'))

## Solução para dias úteis descasados: repetir última observação
dat <- na.locf(dat)

# Converter dados para numericos
storage.mode(dat) <- "numeric"



# Calcular os retornos (Performance Analytics)
dat$Ret.verde <- Return.calculate(dat$Cota,
                          method = "log")%>%na.omit()
dat$Ret.ibov <- Return.calculate(dat$Fechamento.ibov,
                          method = "log")%>%na.omit()
dat$Ret.snp <- Return.calculate(dat$Fechamento.snp,
                          method = "log")%>%na.omit()
dat$Ret.imab5 <- Return.calculate(dat$Fechamento.imab5,
                          method = "log")%>%na.omit()
dat$Ret.imab5p <- Return.calculate(dat$Fechamento.imab5p,
                          method = "log")%>%na.omit()
dat$Ret.dolar <- Return.calculate(dat$Fechamento.dolar,
                          method = "log")%>%na.omit()
dat$Ret.di17 <- Return.calculate(dat$Fechamento.di17,
                          method = "log")%>%na.omit()
dat$Ret.di19 <- Return.calculate(dat$Fechamento.di19,
                          method = "log")%>%na.omit()
dat$Ret.di21 <- Return.calculate(dat$Fechamento.di21,
                          method = "log")%>%na.omit()
dat$Ret.di23 <- Return.calculate(dat$Fechamento.di23,
                          method = "log")%>%na.omit()
dat$Ret.di25 <- Return.calculate(dat$Fechamento.di25,
                          method = "log")%>%na.omit()
```

```{r janelas, echo = T, eval = T, include = T}
# Selecionar janelas de interesse
index(dat) <- as.Date(index(dat))

## Janela 1: janela de 70 dias até 2016-07-01
end_date <- index(dat[index(dat)>='2016-07-01',][1,])
start_date <- index(dat)[match(end_date,index(dat))-69]
jan1 <- window(dat, start = start_date, end = end_date)
str(jan1)

## Janela 2: janela de 70 dias até 2018-07-01
end_date <- index(dat[index(dat)>='2018-07-01',][1,])
start_date <- index(dat)[match(end_date,index(dat))-69]
jan2 <- window(dat, start = start_date, end = end_date)
str(jan2)

## Janela 3: janela de 70 dias até 2020-07-01
end_date <- index(dat[index(dat)>='2020-07-01',][1,])
start_date <- index(dat)[match(end_date,index(dat))-69]
jan3 <- window(dat, start = start_date, end = end_date)
str(jan3)
```


```{r statisticas, echo = T, eval = T, include = T}
#Para c/ janela de tempo de cada fator calculamos as estatiscas descritivas.

## Janela 1:

media1 <- with(jan1, cbind(mean(Ret.verde), mean(Ret.ibov), mean(Ret.snp), mean(Ret.imab5), mean(Ret.imab5p), mean(Ret.dolar), mean(Ret.di17), mean(Ret.di21)))

ep1 <- with(jan1, cbind(sd(Ret.verde), sd(Ret.ibov), sd(Ret.snp), sd(Ret.imab5), sd(Ret.imab5p), sd(Ret.dolar), sd(Ret.di17), sd(Ret.di21)))

skew1 <- with(jan1, cbind(skewness(Ret.verde), skewness(Ret.ibov), skewness(Ret.snp), skewness(Ret.imab5), skewness(Ret.imab5p), skewness(Ret.dolar), skewness(Ret.di17), skewness(Ret.di21)))

kurt1 <- with(jan1, cbind(kurtosis(Ret.verde), kurtosis(Ret.ibov), kurtosis(Ret.snp), kurtosis(Ret.imab5), kurtosis(Ret.imab5p), kurtosis(Ret.dolar), kurtosis(Ret.di17), kurtosis(Ret.di21)))

## Janela 2:
media2 <- with(jan2, cbind(mean(Ret.verde), mean(Ret.ibov), mean(Ret.snp), mean(Ret.imab5), mean(Ret.imab5p), mean(Ret.dolar), mean(Ret.di19), mean(Ret.di23)))

ep2 <- with(jan2, cbind(sd(Ret.verde), sd(Ret.ibov), sd(Ret.snp), sd(Ret.imab5), sd(Ret.imab5p), sd(Ret.dolar), sd(Ret.di19), sd(Ret.di23)))

skew2 <- with(jan2, cbind(skewness(Ret.verde), skewness(Ret.ibov), skewness(Ret.snp), skewness(Ret.imab5), skewness(Ret.imab5p), skewness(Ret.dolar), skewness(Ret.di19), skewness(Ret.di23)))

kurt2 <- with(jan2, cbind(kurtosis(Ret.verde), kurtosis(Ret.ibov), kurtosis(Ret.snp), kurtosis(Ret.imab5), kurtosis(Ret.imab5p), kurtosis(Ret.dolar), kurtosis(Ret.di19), kurtosis(Ret.di23)))

## Janela 3:

media3 <- with(jan3, cbind(mean(Ret.verde), mean(Ret.ibov), mean(Ret.snp), mean(Ret.imab5), mean(Ret.imab5p), mean(Ret.dolar), mean(Ret.di21), mean(Ret.di25)))

ep3 <- with(jan3, cbind(sd(Ret.verde), sd(Ret.ibov), sd(Ret.snp), sd(Ret.imab5), sd(Ret.imab5p), sd(Ret.dolar), sd(Ret.di21), sd(Ret.di25)))

skew3 <- with(jan3, cbind(skewness(Ret.verde), skewness(Ret.ibov), skewness(Ret.snp), skewness(Ret.imab5), skewness(Ret.imab5p), skewness(Ret.dolar), skewness(Ret.di21), skewness(Ret.di25)))

kurt3 <- with(jan3, cbind(kurtosis(Ret.verde), kurtosis(Ret.ibov), kurtosis(Ret.snp), kurtosis(Ret.imab5), kurtosis(Ret.imab5p), kurtosis(Ret.dolar), kurtosis(Ret.di21), kurtosis(Ret.di25)))

```

**Estatisticas Janela 1:**

Fator| Mean| Standard Deviation| Skewness| Kurtosis
------------- | -------------| -------------| -------------| -------------
Ret.verde | `r  media1[,1]`|`r  ep1[,1]`|`r  skew1[,1]`|`r  kurt1[,1]`
Ret.ibov | `r  media1[,2]`|`r  ep1[,2]`|`r  skew1[,2]`|`r  kurt1[,2]`
Ret.snp | `r  media1[,3]`|`r  ep1[,3]`|`r  skew1[,3]`|`r  kurt1[,3]`
Ret.imab5 | `r  media1[,4]`|`r  ep1[,4]`|`r  skew1[,4]`|`r  kurt1[,4]`
Ret.imab5p | `r  media1[,5]`|`r  ep1[,5]`|`r  skew1[,5]`|`r  kurt1[,5]`
Ret.dolar | `r  media1[,6]`|`r  ep1[,6]`|`r  skew1[,6]`|`r  kurt1[,6]`
Ret.di17 | `r  media1[,7]`|`r  ep1[,7]`|`r  skew1[,7]`|`r  kurt1[,7]`
Ret.di21 | `r  media1[,8]`|`r  ep1[,8]`|`r  skew1[,8]`|`r  kurt1[,8]`

**Estatisticas Janela 2:**

Fator| Mean| Standard Deviation| Skewness| Kurtosis
------------- | -------------| -------------| -------------| -------------
Ret.verde | `r  media2[,1]`|`r  ep2[,1]`|`r  skew2[,1]`|`r  kurt2[,1]`
Ret.ibov | `r  media2[,2]`|`r  ep2[,2]`|`r  skew2[,2]`|`r  kurt2[,2]`
Ret.snp | `r  media2[,3]`|`r  ep2[,3]`|`r  skew2[,3]`|`r  kurt2[,3]`
Ret.imab5 | `r  media2[,4]`|`r  ep2[,4]`|`r  skew2[,4]`|`r  kurt2[,4]`
Ret.imab5p | `r  media2[,5]`|`r  ep2[,5]`|`r  skew2[,5]`|`r  kurt2[,5]`
Ret.dolar | `r  media2[,6]`|`r  ep2[,6]`|`r  skew2[,6]`|`r  kurt2[,6]`
Ret.di19 | `r  media2[,7]`|`r  ep2[,7]`|`r  skew2[,7]`|`r  kurt2[,7]`
Ret.di23 | `r  media2[,8]`|`r  ep2[,8]`|`r  skew2[,8]`|`r  kurt2[,8]`

**Estatisticas Janela 3:**

Fator| Mean| Standard Deviation| Skewness| Kurtosis
------------- | -------------| -------------| -------------| -------------
Ret.verde | `r  media3[,1]`|`r  ep3[,1]`|`r  skew3[,1]`|`r  kurt3[,1]`
Ret.ibov | `r  media3[,2]`|`r  ep3[,2]`|`r  skew3[,2]`|`r  kurt3[,2]`
Ret.snp | `r  media3[,3]`|`r  ep3[,3]`|`r  skew3[,3]`|`r  kurt3[,3]`
Ret.imab5 | `r  media3[,4]`|`r  ep3[,4]`|`r  skew3[,4]`|`r  kurt3[,4]`
Ret.imab5p | `r  media3[,5]`|`r  ep3[,5]`|`r  skew3[,5]`|`r  kurt3[,5]`
Ret.dolar | `r  media3[,6]`|`r  ep3[,6]`|`r  skew3[,6]`|`r  kurt3[,6]`
Ret.di21 | `r  media3[,7]`|`r  ep3[,7]`|`r  skew3[,7]`|`r  kurt3[,7]`
Ret.di25 | `r  media3[,8]`|`r  ep3[,8]`|`r  skew3[,8]`|`r  kurt3[,8]`

**Matriz de correlacoes entre os fatores Janela 1:**

Fator| Ret.ibov| Ret.snp| Ret.imab5| Ret.imab5p|Ret.dolar|Ret.di17|Ret.di21
------------- | -------------| -------------| -------------| -------------| -------------| -------------| -------------
Ret.ibov | `r  cor(jan1$Ret.ibov, jan1$Ret.ibov)`|`r  cor(jan1$Ret.ibov, jan1$Ret.snp)`|`r  cor(jan1$Ret.ibov, jan1$Ret.imab5)`|`r  cor(jan1$Ret.ibov, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.ibov, jan1$Ret.dolar)`|`r  cor(jan1$Ret.ibov, jan1$Ret.di17)`|`r  cor(jan1$Ret.ibov, jan1$Ret.di21)`
Ret.snp | `r  cor(jan1$Ret.snp, jan1$Ret.ibov)`|`r  cor(jan1$Ret.snp, jan1$Ret.snp)`|`r  cor(jan1$Ret.snp, jan1$Ret.imab5)`|`r  cor(jan1$Ret.snp, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.snp, jan1$Ret.dolar)`|`r  cor(jan1$Ret.snp, jan1$Ret.di17)`|`r  cor(jan1$Ret.snp, jan1$Ret.di21)`
Ret.imab5 | `r  cor(jan1$Ret.imab5, jan1$Ret.ibov)`|`r  cor(jan1$Ret.imab5, jan1$Ret.snp)`|`r  cor(jan1$Ret.imab5, jan1$Ret.imab5)`|`r  cor(jan1$Ret.imab5, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.imab5, jan1$Ret.dolar)`|`r  cor(jan1$Ret.imab5, jan1$Ret.di17)`|`r  cor(jan1$Ret.imab5, jan1$Ret.di21)`
Ret.imab5p | `r  cor(jan1$Ret.imab5p, jan1$Ret.ibov)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.snp)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.imab5)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.dolar)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.di17)`|`r  cor(jan1$Ret.imab5p, jan1$Ret.di21)`
Ret.dolar | `r  cor(jan1$Ret.dolar, jan1$Ret.ibov)`|`r  cor(jan1$Ret.dolar, jan1$Ret.snp)`|`r  cor(jan1$Ret.dolar, jan1$Ret.imab5)`|`r  cor(jan1$Ret.dolar, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.dolar, jan1$Ret.dolar)`|`r  cor(jan1$Ret.dolar, jan1$Ret.di17)`|`r  cor(jan1$Ret.dolar, jan1$Ret.di21)`
Ret.di17 | `r  cor(jan1$Ret.di17, jan1$Ret.ibov)`|`r  cor(jan1$Ret.di17, jan1$Ret.snp)`|`r  cor(jan1$Ret.di17, jan1$Ret.imab5)`|`r  cor(jan1$Ret.di17, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.di17, jan1$Ret.dolar)`|`r  cor(jan1$Ret.di17, jan1$Ret.di17)`|`r  cor(jan1$Ret.di17, jan1$Ret.di21)`
Ret.di21 | `r  cor(jan1$Ret.di21, jan1$Ret.ibov)`|`r  cor(jan1$Ret.di21, jan1$Ret.snp)`|`r  cor(jan1$Ret.di21, jan1$Ret.imab5)`|`r  cor(jan1$Ret.di21, jan1$Ret.imab5p)`|`r  cor(jan1$Ret.di21, jan1$Ret.dolar)`|`r  cor(jan1$Ret.di21, jan1$Ret.di17)`|`r  cor(jan1$Ret.di21, jan1$Ret.di21)`

**Matriz de correlacoes entre os fatores Janela 2:**

Fator| Ret.ibov| Ret.snp| Ret.imab5| Ret.imab5p|Ret.dolar|Ret.di19|Ret.di23
------------- | -------------| -------------| -------------| -------------| -------------| -------------| -------------
Ret.ibov | `r  cor(jan2$Ret.ibov, jan2$Ret.ibov)`|`r  cor(jan2$Ret.ibov, jan2$Ret.snp)`|`r  cor(jan2$Ret.ibov, jan2$Ret.imab5)`|`r  cor(jan2$Ret.ibov, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.ibov, jan2$Ret.dolar)`|`r  cor(jan2$Ret.ibov, jan2$Ret.di19)`|`r  cor(jan2$Ret.ibov, jan2$Ret.di23)`
Ret.snp | `r  cor(jan2$Ret.snp, jan2$Ret.ibov)`|`r  cor(jan2$Ret.snp, jan2$Ret.snp)`|`r  cor(jan2$Ret.snp, jan2$Ret.imab5)`|`r  cor(jan2$Ret.snp, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.snp, jan2$Ret.dolar)`|`r  cor(jan2$Ret.snp, jan2$Ret.di19)`|`r  cor(jan2$Ret.snp, jan2$Ret.di23)`
Ret.imab5 | `r  cor(jan2$Ret.imab5, jan2$Ret.ibov)`|`r  cor(jan2$Ret.imab5, jan2$Ret.snp)`|`r  cor(jan2$Ret.imab5, jan2$Ret.imab5)`|`r  cor(jan2$Ret.imab5, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.imab5, jan2$Ret.dolar)`|`r  cor(jan2$Ret.imab5, jan2$Ret.di19)`|`r  cor(jan2$Ret.imab5, jan2$Ret.di23)`
Ret.imab5p | `r  cor(jan2$Ret.imab5p, jan2$Ret.ibov)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.snp)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.imab5)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.dolar)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.di19)`|`r  cor(jan2$Ret.imab5p, jan2$Ret.di23)`
Ret.dolar | `r  cor(jan2$Ret.dolar, jan2$Ret.ibov)`|`r  cor(jan2$Ret.dolar, jan2$Ret.snp)`|`r  cor(jan2$Ret.dolar, jan2$Ret.imab5)`|`r  cor(jan2$Ret.dolar, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.dolar, jan2$Ret.dolar)`|`r  cor(jan2$Ret.dolar, jan2$Ret.di19)`|`r  cor(jan2$Ret.dolar, jan2$Ret.di23)`
Ret.di19 | `r  cor(jan2$Ret.di19, jan2$Ret.ibov)`|`r  cor(jan2$Ret.di19, jan2$Ret.snp)`|`r  cor(jan2$Ret.di19, jan2$Ret.imab5)`|`r  cor(jan2$Ret.di19, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.di19, jan2$Ret.dolar)`|`r  cor(jan2$Ret.di19, jan2$Ret.di19)`|`r  cor(jan2$Ret.di19, jan2$Ret.di23)`
Ret.di23 | `r  cor(jan2$Ret.di23, jan2$Ret.ibov)`|`r  cor(jan2$Ret.di23, jan2$Ret.snp)`|`r  cor(jan2$Ret.di23, jan2$Ret.imab5)`|`r  cor(jan2$Ret.di23, jan2$Ret.imab5p)`|`r  cor(jan2$Ret.di23, jan2$Ret.dolar)`|`r  cor(jan2$Ret.di23, jan2$Ret.di19)`|`r  cor(jan2$Ret.di23, jan2$Ret.di23)`

**Matriz de correlacoes entre os fatores Janela 3:**

Fator| Ret.ibov| Ret.snp| Ret.imab5| Ret.imab5p|Ret.dolar|Ret.di21|Ret.di25
------------- | -------------| -------------| -------------| -------------| -------------| -------------| -------------
Ret.ibov | `r  cor(jan3$Ret.ibov, jan3$Ret.ibov)`|`r  cor(jan3$Ret.ibov, jan3$Ret.snp)`|`r  cor(jan3$Ret.ibov, jan3$Ret.imab5)`|`r  cor(jan3$Ret.ibov, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.ibov, jan3$Ret.dolar)`|`r  cor(jan3$Ret.ibov, jan3$Ret.di21)`|`r  cor(jan3$Ret.ibov, jan3$Ret.di25)`
Ret.snp | `r  cor(jan3$Ret.snp, jan3$Ret.ibov)`|`r  cor(jan3$Ret.snp, jan3$Ret.snp)`|`r  cor(jan3$Ret.snp, jan3$Ret.imab5)`|`r  cor(jan3$Ret.snp, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.snp, jan3$Ret.dolar)`|`r  cor(jan3$Ret.snp, jan3$Ret.di21)`|`r  cor(jan3$Ret.snp, jan3$Ret.di25)`
Ret.imab5 | `r  cor(jan3$Ret.imab5, jan3$Ret.ibov)`|`r  cor(jan3$Ret.imab5, jan3$Ret.snp)`|`r  cor(jan3$Ret.imab5, jan3$Ret.imab5)`|`r  cor(jan3$Ret.imab5, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.imab5, jan3$Ret.dolar)`|`r  cor(jan3$Ret.imab5, jan3$Ret.di21)`|`r  cor(jan3$Ret.imab5, jan3$Ret.di25)`
Ret.imab5p | `r  cor(jan3$Ret.imab5p, jan3$Ret.ibov)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.snp)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.imab5)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.dolar)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.di21)`|`r  cor(jan3$Ret.imab5p, jan3$Ret.di25)`
Ret.dolar | `r  cor(jan3$Ret.dolar, jan3$Ret.ibov)`|`r  cor(jan3$Ret.dolar, jan3$Ret.snp)`|`r  cor(jan3$Ret.dolar, jan3$Ret.imab5)`|`r  cor(jan3$Ret.dolar, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.dolar, jan3$Ret.dolar)`|`r  cor(jan3$Ret.dolar, jan3$Ret.di21)`|`r  cor(jan3$Ret.dolar, jan3$Ret.di25)`
Ret.di21 | `r  cor(jan3$Ret.di21, jan3$Ret.ibov)`|`r  cor(jan3$Ret.di21, jan3$Ret.snp)`|`r  cor(jan3$Ret.di21, jan3$Ret.imab5)`|`r  cor(jan3$Ret.di21, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.di21, jan3$Ret.dolar)`|`r  cor(jan3$Ret.di21, jan3$Ret.di21)`|`r  cor(jan3$Ret.di21, jan3$Ret.di25)`
Ret.di25 | `r  cor(jan3$Ret.di25, jan3$Ret.ibov)`|`r  cor(jan3$Ret.di25, jan3$Ret.snp)`|`r  cor(jan3$Ret.di25, jan3$Ret.imab5)`|`r  cor(jan3$Ret.di25, jan3$Ret.imab5p)`|`r  cor(jan3$Ret.di25, jan3$Ret.dolar)`|`r  cor(jan3$Ret.di25, jan3$Ret.di21)`|`r  cor(jan3$Ret.di25, jan3$Ret.di25)`


```{r regres, echo = T, eval = T, include = T}
# Regressão linear OLS
## Regressão da janela 1 (2016)
regres1 <- lm(Ret.verde~Ret.ibov+Ret.snp+Ret.imab5+Ret.imab5p+
               Ret.dolar+Ret.di17+Ret.di21, data=jan1)
summary(regres1)

## Regressão da janela 2 (2018)
regres2 <- lm(Ret.verde~Ret.ibov+Ret.snp+Ret.imab5+Ret.imab5p+
               Ret.dolar+Ret.di19+Ret.di23, data=jan2)
summary(regres2)

## Regressão da janela 3 (2020)
regres3 <- lm(Ret.verde~Ret.ibov+Ret.snp+Ret.imab5+Ret.imab5p+
               Ret.dolar+Ret.di21+Ret.di25, data=jan3)
summary(regres3)
```



```{r histograma, echo = F, eval = T, include = F}
# Histogramas dos retornos
## Vale fazer um facet grid dos retornos?
his <- jan1 %>%
    ggplot(aes(x=Ret.ibov)) +
        geom_histogram(binwidth=0.01, fill="#69b3a2", 
                       color="#e9ecef", alpha=0.9) +
        xlab("Daily Returns") +
        ylab("Frequency")
his
```

### Metodologia (OLS)

##### 1. Relação Linear (nos coeficientes)

##### 2. Média Condicional Zero

##### 3. Amostra Aleatória (iid)

##### 4. Multicolinearidade não-perfeita

##### 5. Homocedasticidade


### Report Results

### Conclusão

